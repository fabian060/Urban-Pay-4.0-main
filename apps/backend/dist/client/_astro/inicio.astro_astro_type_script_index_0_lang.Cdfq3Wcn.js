import{k as b,B as E}from"./endpoints.JZqDPgRs.js";async function I(){const m=document.getElementById("total-pendientes"),s=document.getElementById("proximo-vencimiento"),a=document.getElementById("estado-cuenta"),c=document.getElementById("mensaje-estado"),u=document.getElementById("total-pagado-anio"),x=document.getElementById("cantidad-pagos-anio"),p=document.getElementById("actividad-reciente-container");try{const[o,l]=await Promise.all([b.get(`${E}/api/cuotas`,{credentials:"include"}).json(),b.get(`${E}/api/payment`,{credentials:"include"}).json()]);if(l.length>0){const t=[...l].sort((e,n)=>new Date(n.date)-new Date(e.date)).slice(0,5);p.innerHTML="",t.forEach(e=>{const n=o.find(P=>P.id===e.cuota_id),g=n?Number(n.monto).toFixed(2):"N/A",C=n?n.name||`Cuota de ${new Date(n.date_limit).toLocaleString("es-ES",{month:"long"})}`:"Concepto no encontrado",$=new Date(e.date).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"});let i="",r="";switch(e.status){case"accepted":i="bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",r="Aceptado";break;case"rejected":i="bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",r="Rechazado";break;default:i="bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",r="Pendiente";break}const v=`
            <div class="flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50">
              <div>
                <p class="font-medium text-gray-800 dark:text-gray-200">${C}</p>
                <p class="text-sm text-gray-500 dark:text-gray-400">Pagado el: ${$}</p>
              </div>
              <div class="text-right">
                <p class="font-semibold text-gray-900 dark:text-white">$${g}</p>
                <span class="px-2 py-1 text-xs font-medium rounded-full ${i}">${r}</span>
              </div>
            </div>
          `;p.insertAdjacentHTML("beforeend",v)})}const f=l.filter(t=>t.status==="accepted"),h=f.map(t=>t.cuota_id),d=o.filter(t=>!h.includes(t.id)),D=d.reduce((t,e)=>t+Number(e.monto),0),k=new Date().getFullYear(),y=f.filter(t=>new Date(t.date).getFullYear()===k),w=y.reduce((t,e)=>{const n=o.find(g=>g.id===e.cuota_id);return t+(n?Number(n.monto):0)},0);if(u&&(u.textContent=`$${w.toFixed(2)}`),x&&(x.textContent=`${y.length} Pagos`),m&&(m.textContent=`$${D.toFixed(2)}`),d.length>0){if(d.sort((t,e)=>new Date(t.date_limit)-new Date(e.date_limit)),s){const t=new Date(d[0].date_limit);s.textContent=t.toLocaleDateString("es-ES",{day:"numeric",month:"long"})}a&&(a.textContent="Con Deuda",a.className="text-2xl font-bold text-red-500 dark:text-red-400"),c&&(c.textContent=`Tienes ${d.length} cuotas pendientes`)}else s&&(s.textContent="-"),a&&(a.textContent="Al d√≠a",a.className="text-2xl font-bold text-green-500 dark:text-green-400"),c&&(c.textContent="No tienes deudas pendientes")}catch(o){console.error("Error cargando datos del dashboard",o)}}I();
